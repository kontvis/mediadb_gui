{% extends 'base.html' %}
{% block content %}
  <h2>Add Video</h2>
  <form method="post">
    <div class="mb-3">
      <label class="form-label">Title *</label>
      <input name="title" class="form-control" placeholder="Enter title" required>
    </div>
    <div class="mb-3">
      <label class="form-label">Director</label>
      <input name="director" class="form-control">
    </div>
    <div class="mb-3">
      <label class="form-label">Runtime (minutes)</label>
      <input name="runtime_minutes" class="form-control" type="number">
    </div>
    <div class="mb-3">
      <label class="form-label">Rating</label>
      <input name="rating" class="form-control" placeholder="e.g., PG-13">
    </div>
    <div class="mb-3">
      <label class="form-label">Format</label>
      <input name="format" class="form-control" placeholder="DVD / Blu-ray / MP4">
    </div>
    <div class="mb-3">
      <label class="form-label">Genre</label>
      <input name="genre" class="form-control">
    </div>
    <div class="mb-3">
      <label class="form-label">Year</label>
      <input name="year" class="form-control">
    </div>
    <div class="mb-3">
      <label class="form-label">Notes</label>
      <textarea name="notes" class="form-control"></textarea>
    </div>
    <button class="btn btn-primary">Add Video</button>
  </form>
  <script>
    (function(){
      try {
        const raw = localStorage.getItem('barcode_prefill');
        if (!raw) return;
        const data = JSON.parse(raw);
        if (!data) return;
        if (data.title) document.querySelector('input[name=title]').value = data.title;
        if (data.director) document.querySelector('input[name=director]').value = data.director;
        if (data.runtime_minutes) document.querySelector('input[name=runtime_minutes]').value = data.runtime_minutes;
        if (data.rating) document.querySelector('input[name=rating]').value = data.rating;
        if (data.video_format) document.querySelector('input[name=format]').value = data.video_format;
        if (data.video_genre) document.querySelector('input[name=genre]').value = data.video_genre;
        if (data.year) document.querySelector('input[name=year]').value = data.year;
        if (data.notes) document.querySelector('textarea[name=notes]').value = data.notes;
        localStorage.removeItem('barcode_prefill');
      } catch(e) { console.error(e); }
    })();
  </script>
{% endblock %}
